<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Lecture 3: Data Manipulation with dplyr – STAT545 @ UBC</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-f55b795d08b5ec9c46d466a81ca0990b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">STAT545 @ UBC</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-syllabus" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Syllabus</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-syllabus">    
        <li>
    <a class="dropdown-item" href="../../webpages/syllabus/syllabusA.html">
 <span class="dropdown-text">Syllabus: STAT 545 A (Part I)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../webpages/syllabus/syllabusB.html">
 <span class="dropdown-text">Syllabus: STAT 545 B (Part II)</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-lectures" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Lectures</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-lectures">    
        <li>
    <a class="dropdown-item" href="../../webpages/lectures/lec1a_installation.html">
 <span class="dropdown-text">Lecture 1A: Installation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../webpages/lectures/lec1b_introR.html">
 <span class="dropdown-text">Lecture 1B: Course Introduction and R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../webpages/lectures/lec2A_reproducibility.html">
 <span class="dropdown-text">Lecture 2A: Reproducibility</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../webpages/lectures/lec2b_versioncontrol.html">
 <span class="dropdown-text">Lecture 2B: Version Control</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../webpages/lectures/lec3_dplyr.html">
 <span class="dropdown-text">Lecture 3: Data Manipulation with dplyr</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../webpages/lectures/lec4_datavis.html">
 <span class="dropdown-text">Lecture 4: Data Visualization</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../webpages/lectures/lec5_tidydata.html">
 <span class="dropdown-text">Lecture 5: Tidy Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../webpages/lectures/lec6a_modelfitting.html">
 <span class="dropdown-text">Lecture 6A: Model Fitting</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../webpages/lectures/lec6b_dates.html">
 <span class="dropdown-text">Lecture 6B: Factors and Dates</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../webpages/lectures/lec7_rrdata_tibble.html">
 <span class="dropdown-text">Lecture 7: Reading and Writing Data, Tibble Joins</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../webpages/worksheets.html"> 
<span class="menu-text">Worksheets</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-collaborative-project" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Collaborative Project</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-collaborative-project">    
        <li>
    <a class="dropdown-item" href="../../webpages/collabproj/collabproj_deliverable1.html">
 <span class="dropdown-text">Collaborative Project: Deliverable 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../webpages/collabproj/collabproj_deliverable2.html">
 <span class="dropdown-text">Collaborative Project: Deliverable 2</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-mini-data-analysis" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Mini Data Analysis</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-mini-data-analysis">    
        <li>
    <a class="dropdown-item" href="../../webpages/mda/mda_deliverable1.html">
 <span class="dropdown-text">Mini Data Analysis: Deliverable 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../webpages/mda/mda_deliverable2.html">
 <span class="dropdown-text">Mini Data Analysis: Deliverable 2</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../webpages/faq.html"> 
<span class="menu-text">FAQ</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../webpages/lectures/lec3_dplyr.html">Lecture 3: Data Manipulation with dplyr</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../webpages/lectures/lec1a_installation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 1A: Installation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../webpages/lectures/lec1b_introR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 1B: Course Introduction and R</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../webpages/lectures/lec2A_reproducibility.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 2A: Reproducibility</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../webpages/lectures/lec2b_versioncontrol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 2B: Version Control</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../webpages/lectures/lec3_dplyr.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Lecture 3: Data Manipulation with dplyr</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../webpages/lectures/lec4_datavis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 4: Data Visualization</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../webpages/lectures/lec5_tidydata.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 5: Tidy Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../webpages/lectures/lec6a_modelfitting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 6A: Model Fitting</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../webpages/lectures/lec6b_dates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 6B: Factors and Dates</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../webpages/lectures/lec7_rrdata_tibble.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 7: Reading and Writing Data, Tibble Joins</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#learning-objectives" id="toc-learning-objectives" class="nav-link active" data-scroll-target="#learning-objectives">Learning Objectives</a></li>
  <li><a href="#why-data-manipulation" id="toc-why-data-manipulation" class="nav-link" data-scroll-target="#why-data-manipulation">Why Data Manipulation?</a></li>
  <li><a href="#tibbles" id="toc-tibbles" class="nav-link" data-scroll-target="#tibbles">Tibbles</a></li>
  <li><a href="#dplyr-functions" id="toc-dplyr-functions" class="nav-link" data-scroll-target="#dplyr-functions"><code>dplyr</code> Functions</a>
  <ul class="collapse">
  <li><a href="#subsetting-with-select" id="toc-subsetting-with-select" class="nav-link" data-scroll-target="#subsetting-with-select">Subsetting with <code>select()</code></a></li>
  <li><a href="#subsetting-with-filter" id="toc-subsetting-with-filter" class="nav-link" data-scroll-target="#subsetting-with-filter">Subsetting with <code>filter()</code></a></li>
  <li><a href="#leveling-up-with-tidyselect" id="toc-leveling-up-with-tidyselect" class="nav-link" data-scroll-target="#leveling-up-with-tidyselect">Leveling Up with <code>tidyselect()</code></a></li>
  <li><a href="#creating-new-variables-with-mutate" id="toc-creating-new-variables-with-mutate" class="nav-link" data-scroll-target="#creating-new-variables-with-mutate">Creating New Variables with <code>mutate()</code></a></li>
  <li><a href="#the-pipe-operator" id="toc-the-pipe-operator" class="nav-link" data-scroll-target="#the-pipe-operator">The Pipe Operator <code>%&gt;%</code></a></li>
  </ul></li>
  <li><a href="#try-it-yourself" id="toc-try-it-yourself" class="nav-link" data-scroll-target="#try-it-yourself">Try it Yourself!</a></li>
  <li><a href="#next-class-fev-case-study" id="toc-next-class-fev-case-study" class="nav-link" data-scroll-target="#next-class-fev-case-study">Next Class: FEV Case Study</a></li>
  <li><a href="#resources" id="toc-resources" class="nav-link" data-scroll-target="#resources">Resources</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lecture 3: Data Manipulation with dplyr</h1>
<p class="subtitle lead">September 16, 2025</p>
</div>



<div class="quarto-title-meta">

    
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">July 29, 2025</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="learning-objectives" class="level2">
<h2 class="anchored" data-anchor-id="learning-objectives">Learning Objectives</h2>
<p>From this topic, students are anticipated to be able to:</p>
<ol type="1">
<li><p>Use the five core dplyr verbs for data wrangling: <code>select()</code>, <code>filter()</code>, <code>arrange()</code>, <code>mutate()</code>, <code>summarise()</code>.</p></li>
<li><p>Use piping when implementing function chains.</p></li>
<li><p>Use <code>group_by()</code> to operate within groups (of rows) with <code>mutate()</code> and <code>summarise()</code>.</p></li>
<li><p>Use <code>across()</code> to operate on multiple columns with <code>summarise()</code> and <code>mutate()</code>.</p></li>
</ol>
<p>We will spend two classes on this topic.</p>
</section>
<section id="why-data-manipulation" class="level2">
<h2 class="anchored" data-anchor-id="why-data-manipulation">Why Data Manipulation?</h2>
<p>You have a shiny new data set - great! You might be tempted to dive right in and start making pretty graphs and fitting cool models to your data. Not so fast! In practice, it’s very rare that you have the data in the exact right form to make the graph you want, or fit the model you want. You will need to start by <em>manipulating</em> your data into the right form: creating new variables, subsetting rows, renaming columns, etc.</p>
<p>Plus, an important piece of data analysis output is tables that summarize the data in some way. For example, it is extremely standard practice in biomedical and public health studies to have the first table of any journal article summarize basic characteristics of the study population, possibly stratified by exposure. While these tables are less pretty than graphs, they can nevertheless be very insightful!</p>
<p>An even less exciting but perhaps even more important part of data analysis is simply checking the data for things like:</p>
<ul>
<li><p>Possible inconsistencies with your understanding of what the data set should contain</p></li>
<li><p>Possible errors</p></li>
<li><p>Basic info gathering: number of rows, number of columns, amount of missing data, etc.</p></li>
</ul>
<p>All of these require data manipulation. We choose to use the <code>dplyr</code> (pronounced d-plier) package for this.</p>
</section>
<section id="tibbles" class="level2">
<h2 class="anchored" data-anchor-id="tibbles">Tibbles</h2>
<p>As mentioned in Lecture 1A, <em>data frames</em> are useful tools for storing data. You can think of it as a spreadsheet of information, but in R. A <em>tibble</em> is a modern version of a basic data frame. To use tibbles, we first install the <code>tibble</code> package (if we haven’t already) and load it into R by:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("tibble") # remove comment if not already installed</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Tibbles typically said to be more user friendly than standard R dataframes, and are easily used with <em>tidyverse</em> functions. More on that in a bit!</p>
<p>We can either load in pre-existing data frames (like from a <code>.csv</code> file or an R package), or create a tibble manually using the <code>tibble()</code> function. For example, we could use</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">x =</span> letters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 26 × 1
   x    
   &lt;chr&gt;
 1 a    
 2 b    
 3 c    
 4 d    
 5 e    
 6 f    
 7 g    
 8 h    
 9 i    
10 j    
# ℹ 16 more rows</code></pre>
</div>
</div>
<p>to have a single column tibble of letters of the alphabet, or</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>housingdata <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">"Grace"</span>, <span class="st">"Mei"</span>, <span class="st">"Steven"</span>, <span class="st">"Phuong"</span>, <span class="st">"Omar"</span>, <span class="st">"Richa"</span>, <span class="st">"Bruce"</span>, <span class="st">"David"</span>), </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">numrooms =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>), </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">rent_2024 =</span> <span class="fu">c</span>(<span class="dv">2665</span>, <span class="dv">4900</span>, <span class="dv">2900</span>, <span class="dv">4950</span>, <span class="dv">2400</span>, <span class="dv">1000</span>, <span class="dv">2800</span>, <span class="dv">2350</span>),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">rent_2025 =</span> <span class="fu">c</span>(<span class="dv">2700</span>, <span class="dv">5000</span>, <span class="dv">2900</span>, <span class="dv">5000</span>, <span class="dv">2500</span>, <span class="dv">1000</span>, <span class="dv">2800</span>, <span class="dv">2400</span>),</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">city =</span> <span class="fu">c</span>(<span class="st">"Vancouver"</span>, <span class="st">"Toronto"</span>, <span class="st">"Halifax"</span>, <span class="st">"Vancouver"</span>, <span class="st">"Montreal"</span>, <span class="st">"Victoria"</span>, <span class="st">"Halifax"</span>, <span class="st">"Vancouver"</span>))</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>housingdata</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 5
  name   numrooms rent_2024 rent_2025 city     
  &lt;chr&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;    
1 Grace         2      2665      2700 Vancouver
2 Mei           3      4900      5000 Toronto  
3 Steven        1      2900      2900 Halifax  
4 Phuong        4      4950      5000 Vancouver
5 Omar          2      2400      2500 Montreal 
6 Richa         1      1000      1000 Victoria 
7 Bruce         3      2800      2800 Halifax  
8 David         2      2350      2400 Vancouver</code></pre>
</div>
</div>
<p>We can see that the tibble can store different data types (here we have both numeric data (“dbl” is short for double) and character data (“chr” is short for character).</p>
<p>We can also change an R data frame to a dibble. For example, the <code>mtcars</code> data set is available in the <code>datasets</code> package in R as a dataframe. We can load it as a tibble using:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(datasets)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(mtcars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 32 × 11
     mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  21       6  160    110  3.9   2.62  16.5     0     1     4     4
 2  21       6  160    110  3.9   2.88  17.0     0     1     4     4
 3  22.8     4  108     93  3.85  2.32  18.6     1     1     4     1
 4  21.4     6  258    110  3.08  3.22  19.4     1     0     3     1
 5  18.7     8  360    175  3.15  3.44  17.0     0     0     3     2
 6  18.1     6  225    105  2.76  3.46  20.2     1     0     3     1
 7  14.3     8  360    245  3.21  3.57  15.8     0     0     3     4
 8  24.4     4  147.    62  3.69  3.19  20       1     0     4     2
 9  22.8     4  141.    95  3.92  3.15  22.9     1     0     4     2
10  19.2     6  168.   123  3.92  3.44  18.3     1     0     4     4
# ℹ 22 more rows</code></pre>
</div>
</div>
</section>
<section id="dplyr-functions" class="level2">
<h2 class="anchored" data-anchor-id="dplyr-functions"><code>dplyr</code> Functions</h2>
<p>To use the dplyr functions, we need to install (if necessary) and load the dplyr package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("dplyr") #remove comment if not installed yet</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Once loaded, we will have a number of new tools at our disposal. Here are a few functions we are going to review in this lecture:</p>
<ul>
<li><code>select()</code>: keep or remove certain columns</li>
</ul>
<section id="subsetting-with-select" class="level3">
<h3 class="anchored" data-anchor-id="subsetting-with-select">Subsetting with <code>select()</code></h3>
<p><code>select()</code> allows you to keep or remove columns. For example, in the <code>housingdata</code> dataset, say we only want the columns <code>name</code> and <code>city</code>. We use the <code>select</code> function where the first argument is the name of the tibble, and the other arguments are the names of the columns we wish to keep:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(housingdata, name, city)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 2
  name   city     
  &lt;chr&gt;  &lt;chr&gt;    
1 Grace  Vancouver
2 Mei    Toronto  
3 Steven Halifax  
4 Phuong Vancouver
5 Omar   Montreal 
6 Richa  Victoria 
7 Bruce  Halifax  
8 David  Vancouver</code></pre>
</div>
</div>
<p>Now, this didn’t alter the original data frame! If we wanted to save this reduced dataframe, we can name it to a new variable, such as</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>housingdata2 <span class="ot">&lt;-</span> <span class="fu">select</span>(housingdata, name, city)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>housingdata2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 2
  name   city     
  &lt;chr&gt;  &lt;chr&gt;    
1 Grace  Vancouver
2 Mei    Toronto  
3 Steven Halifax  
4 Phuong Vancouver
5 Omar   Montreal 
6 Richa  Victoria 
7 Bruce  Halifax  
8 David  Vancouver</code></pre>
</div>
</div>
<p>Now, <code>housingdata2</code> contains only the rows we were interested in keeping, without overriding the original <code>housingdata</code> tibble. We can see that <code>housingdata</code> still contains all of the information from the original data set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>housingdata</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 5
  name   numrooms rent_2024 rent_2025 city     
  &lt;chr&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;    
1 Grace         2      2665      2700 Vancouver
2 Mei           3      4900      5000 Toronto  
3 Steven        1      2900      2900 Halifax  
4 Phuong        4      4950      5000 Vancouver
5 Omar          2      2400      2500 Montreal 
6 Richa         1      1000      1000 Victoria 
7 Bruce         3      2800      2800 Halifax  
8 David         2      2350      2400 Vancouver</code></pre>
</div>
</div>
<p>We can also use <code>select()</code> to indicate which columns to <strong>remove.</strong> For example, if I wanted all variables except <code>name</code> in my data set, I could do:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(housingdata, <span class="sc">-</span>name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 4
  numrooms rent_2024 rent_2025 city     
     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;    
1        2      2665      2700 Vancouver
2        3      4900      5000 Toronto  
3        1      2900      2900 Halifax  
4        4      4950      5000 Vancouver
5        2      2400      2500 Montreal 
6        1      1000      1000 Victoria 
7        3      2800      2800 Halifax  
8        2      2350      2400 Vancouver</code></pre>
</div>
</div>
</section>
<section id="subsetting-with-filter" class="level3">
<h3 class="anchored" data-anchor-id="subsetting-with-filter">Subsetting with <code>filter()</code></h3>
<p>The <code>filter()</code> function allows you to specify which rows to keep in the tibble. The <code>filter()</code> function takes <em>conditional statements</em> and allows us to remove or keep rows based on these conditions.</p>
<p>For example, let’s say we wanted to keep only data where the rent in 2025 (<code>rent_2025</code>) is strictly larger than 2500. Then, we could use:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(housingdata, rent_2025 <span class="sc">&gt;</span> <span class="dv">2500</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 5
  name   numrooms rent_2024 rent_2025 city     
  &lt;chr&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;    
1 Grace         2      2665      2700 Vancouver
2 Mei           3      4900      5000 Toronto  
3 Steven        1      2900      2900 Halifax  
4 Phuong        4      4950      5000 Vancouver
5 Bruce         3      2800      2800 Halifax  </code></pre>
</div>
</div>
<p>Now, only rows with <code>rent_2025</code> &gt; 2500 are kept in the data frame.</p>
<p>We can also use the <code>==</code> sign to indicate that something is equivalent. For example, we may only be interested in observations in Vancouver. To do so, we can use:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(housingdata, city <span class="sc">==</span> <span class="st">"Vancouver"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  name   numrooms rent_2024 rent_2025 city     
  &lt;chr&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;    
1 Grace         2      2665      2700 Vancouver
2 Phuong        4      4950      5000 Vancouver
3 David         2      2350      2400 Vancouver</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The double <code>==</code> in the statement to indicate “is equal to”! Further, as the variable of interest is a string (or character type), we need to use quotations around the city name “Vancouver”.</p>
</div>
</div>
<p>We can also filter on multiple variables at the same time, even if they are different types. for example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(housingdata, rent_2025 <span class="sc">&gt;</span> <span class="dv">2500</span>, city <span class="sc">==</span> <span class="st">"Vancouver"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  name   numrooms rent_2024 rent_2025 city     
  &lt;chr&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;    
1 Grace         2      2665      2700 Vancouver
2 Phuong        4      4950      5000 Vancouver</code></pre>
</div>
</div>
</section>
<section id="leveling-up-with-tidyselect" class="level3">
<h3 class="anchored" data-anchor-id="leveling-up-with-tidyselect">Leveling Up with <code>tidyselect()</code></h3>
<p>Sometimes we will want to select columns that have something in common with their name. This is particularly useful when the number of columns is large (for example, think if we had historical rent data for many years). To do so, we can use helper functions in the <code>tidyverse</code> library. First, install (if necessary) and load in the <code>tidyverse</code> library</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("tidyverse")</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s use the <code>starts_with()</code> function to select all columns that relate to rents. We can do this by:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(housingdata, <span class="fu">starts_with</span>(<span class="st">"rent"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 2
  rent_2024 rent_2025
      &lt;dbl&gt;     &lt;dbl&gt;
1      2665      2700
2      4900      5000
3      2900      2900
4      4950      5000
5      2400      2500
6      1000      1000
7      2800      2800
8      2350      2400</code></pre>
</div>
</div>
<p>This code returned a tibble where only the columns involving rents are included! Other useful helper functions include:</p>
<ul>
<li><p><code>starts_with()</code> finds variables that start with the given input</p></li>
<li><p><code>ends_with()</code> finds variables that end with the given input</p></li>
<li><p><code>contains()</code> finds variables that have the given input at any location in the name</p></li>
</ul>
<p>While for the example data set we are really only selecting two columns, using these functions allows your code to be more flexible as data may be added later for more years of rent, for example.</p>
</section>
<section id="creating-new-variables-with-mutate" class="level3">
<h3 class="anchored" data-anchor-id="creating-new-variables-with-mutate">Creating New Variables with <code>mutate()</code></h3>
<p>Sometimes we need to create another variable or column based on information already present in a tibble. For example, suppose we are interested in the cost per room, rather than total rent, in our data. We can create a new variable that is the rent divided by the number of rooms using <code>mutate()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(housingdata, <span class="at">rent_per_room_2025 =</span> rent_2025<span class="sc">/</span>numrooms)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 6
  name   numrooms rent_2024 rent_2025 city      rent_per_room_2025
  &lt;chr&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;                  &lt;dbl&gt;
1 Grace         2      2665      2700 Vancouver              1350 
2 Mei           3      4900      5000 Toronto                1667.
3 Steven        1      2900      2900 Halifax                2900 
4 Phuong        4      4950      5000 Vancouver              1250 
5 Omar          2      2400      2500 Montreal               1250 
6 Richa         1      1000      1000 Victoria               1000 
7 Bruce         3      2800      2800 Halifax                 933.
8 David         2      2350      2400 Vancouver              1200 </code></pre>
</div>
</div>
<p>We can also clean this up by rounding our new variable to two decimal places using the <code>round()</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(housingdata, <span class="at">rent_per_room_2025 =</span> <span class="fu">round</span>(rent_2025<span class="sc">/</span>numrooms,<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 6
  name   numrooms rent_2024 rent_2025 city      rent_per_room_2025
  &lt;chr&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;                  &lt;dbl&gt;
1 Grace         2      2665      2700 Vancouver              1350 
2 Mei           3      4900      5000 Toronto                1667.
3 Steven        1      2900      2900 Halifax                2900 
4 Phuong        4      4950      5000 Vancouver              1250 
5 Omar          2      2400      2500 Montreal               1250 
6 Richa         1      1000      1000 Victoria               1000 
7 Bruce         3      2800      2800 Halifax                 933.
8 David         2      2350      2400 Vancouver              1200 </code></pre>
</div>
</div>
<p>As we can see, the <code>mutate()</code> function took the data as the first argument, and then we listed the new variable name <code>rent_per_room_2025</code> which we calculated by taking the rent in 2025 (<code>rent_2025</code>) and dividing it by the number of rooms in the house (<code>numrooms</code>). We wrapped <code>round( x, 2)</code> around the calculation to clean up the answer to two decimal places.</p>
</section>
<section id="the-pipe-operator" class="level3">
<h3 class="anchored" data-anchor-id="the-pipe-operator">The Pipe Operator <code>%&gt;%</code></h3>
<p>The pipe operator (<code>%&gt;%</code>) is a convenient way to form a chain of commands on a tibble to perform multiple tasks at once.</p>
<p>Let’s assume we want to modify a tibble using both <code>select()</code> and <code>filter()</code>. We can do so in one single line of code using the pipe operator. But for now, let’s start simple and use just one function using <code>%&gt;%</code>.</p>
<p>Let’s say we want to subset our data and select only the rent and city columns on a tibble. We could use:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(housingdata, <span class="fu">starts_with</span>(<span class="st">"rent"</span>), city)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 3
  rent_2024 rent_2025 city     
      &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;    
1      2665      2700 Vancouver
2      4900      5000 Toronto  
3      2900      2900 Halifax  
4      4950      5000 Vancouver
5      2400      2500 Montreal 
6      1000      1000 Victoria 
7      2800      2800 Halifax  
8      2350      2400 Vancouver</code></pre>
</div>
</div>
<p>which is a perfectly valid answer. However, we could also use the pipe operator, as:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>housingdata <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"rent"</span>), city)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 3
  rent_2024 rent_2025 city     
      &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;    
1      2665      2700 Vancouver
2      4900      5000 Toronto  
3      2900      2900 Halifax  
4      4950      5000 Vancouver
5      2400      2500 Montreal 
6      1000      1000 Victoria 
7      2800      2800 Halifax  
8      2350      2400 Vancouver</code></pre>
</div>
</div>
<p>Here, we tell dplyr the tibble we want to transform (<code>housingdata</code>), and then use the pipe operator (<code>%&gt;%</code>) to tell dplyr what functions we want to perform on it.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>When using the pipe operator, we no longer need to include the dataframe in the first argument of the function. Compare the previous two code chunks to see what I mean.</p>
</div>
</div>
<p>While it may not be obvious from this first example why the pipe operator is commonly used, let’s consider that we want to</p>
<ul>
<li><p>filter on rents for 2025 above $2500</p></li>
<li><p>select all columns aside from name</p></li>
<li><p>create a new variable for the rent per room in 2025 (rounded to 2 decimal places)</p></li>
<li><p>reorder the rows by descending order of 2025 rents</p>
<ul>
<li><p>The <code>arrange()</code> function can change the order of rows.</p></li>
<li><p><code>arrange(desc(column_name))</code> will arrange the roms in descending order for the <code>column_name</code> given. See more <a href="https://cran.r-project.org/web/packages/dplyr/vignettes/dplyr.html#:~:text=Arrange%20rows%20with%20arrange()">here</a>!</p></li>
</ul></li>
</ul>
<p>To do all of these tasks, the pipe operator allows us to write clear and readable code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>housingdata <span class="sc">%&gt;%</span> </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(rent_2025 <span class="sc">&gt;</span> <span class="dv">2500</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>name) <span class="sc">%&gt;%</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rent_per_room_2025 =</span> <span class="fu">round</span>(rent_2025<span class="sc">/</span>numrooms,<span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(rent_2025))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 5
  numrooms rent_2024 rent_2025 city      rent_per_room_2025
     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;                  &lt;dbl&gt;
1        3      4900      5000 Toronto                1667.
2        4      4950      5000 Vancouver              1250 
3        1      2900      2900 Halifax                2900 
4        3      2800      2800 Halifax                 933.
5        2      2665      2700 Vancouver              1350 </code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>After each function call, we need to include the pipe operator to tell dplyr that we’re not done yet, and the chain of commands continues on the next line.</p>
</div>
</div>
<p>Another thing to note is that the pipe operator creates a new tibble and does not alter the original. So, <code>housingdata</code> still contains all of the original rows and columns in its unaltered form. If we wanted to alter it (or save the output to a new variable), we need to assign it using <code>&lt;-</code>. For example, the following code will <u>overwrite</u> the original tibble:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>housingdata <span class="ot">&lt;-</span> housingdata <span class="sc">%&gt;%</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(rent_2025 <span class="sc">&gt;</span> <span class="dv">2500</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>name) <span class="sc">%&gt;%</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">rent_per_room_2025 =</span> <span class="fu">round</span>(rent_2025<span class="sc">/</span>numrooms,<span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(rent_2025))</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>housingdata</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 5
  numrooms rent_2024 rent_2025 city      rent_per_room_2025
     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;                  &lt;dbl&gt;
1        3      4900      5000 Toronto                1667.
2        4      4950      5000 Vancouver              1250 
3        1      2900      2900 Halifax                2900 
4        3      2800      2800 Halifax                 933.
5        2      2665      2700 Vancouver              1350 </code></pre>
</div>
</div>
</section>
</section>
<section id="try-it-yourself" class="level2">
<h2 class="anchored" data-anchor-id="try-it-yourself">Try it Yourself!</h2>
<p>We think the best way to learn the basics of dplyr is to work through Worksheet A2.</p>
<ul>
<li><p>Haven’t attempted all of the questions on Worksheet A2? Then spend this time completing the worksheet.</p></li>
<li><p>Finished attempting all of the questions? Then do the optional <a href="https://r4ds.hadley.nz/data-transform.html">R4DS Data Transformation</a> reading, and maybe even do some of the exercises for extra practice.</p></li>
</ul>
<p>Put any questions you have about the worksheet questions or about data manipulation in Slack.</p>
</section>
<section id="next-class-fev-case-study" class="level2">
<h2 class="anchored" data-anchor-id="next-class-fev-case-study">Next Class: FEV Case Study</h2>
<p>Next class we will be working through <a href="#0">a case study centred on a biomedical data set</a>.</p>
<p>By yourself or in small groups, work through the exercises in the case study. The teaching team will walk around and answer questions and chat about anything data manipulation related.</p>
<p>We will conclude class by going over instructor solutions.</p>
</section>
<section id="resources" class="level2">
<h2 class="anchored" data-anchor-id="resources">Resources</h2>
<ul>
<li><p>Video lecture: <a href="https://youtu.be/Gms3zSPqCk8">dplyr Part 1: Basic Data Manipulation</a></p></li>
<li><p>Video lecture: <a href="https://youtu.be/38BA_v7BwKk">dplyr Part 2: Calculations on tibbles</a></p></li>
<li><p><a href="https://stat545.com/dplyr-intro.html">Chapter 6</a> and <a href="https://stat545.com/dplyr-single.html">Chapter 7</a> of Jenny Bryan’s STAT 545 book follows along with what we will be covering in Day 1 and Day 2 of this topic (although you won’t find the <code>across()</code> function).</p></li>
<li><p>“R for Data Science” is another great resource for learning data wrangling. Take a look at:</p></li>
<li><p><a href="https://cran.r-project.org/web/packages/dplyr/vignettes/dplyr.html">dplyr’s introductory vignette</a> is useful for orienting you to the package.</p></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>