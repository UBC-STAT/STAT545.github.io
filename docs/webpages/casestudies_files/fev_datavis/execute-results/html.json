{
  "hash": "876a81bb4d2b7ab1104ee4ae68cea117",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Data Visualization with FEV Dataset\"\nsubtitle: \"Lecture 4 Case Study\"\nformat: html\n---\n\n\n\n\nCopy and paste the following code into a new RMarkdown Document, or download it [here](https://github.com/UBC-STAT/STAT545.github.io/blob/main/content/casestudies/casestudy_datavis/casestudy_datavis.Rmd).\n\n````         \n---\ntitle: 'FEV Case Study: Graphing'\nauthor: \"Lucy\"\ndate: \"2023-08-28\"\noutput: html_document\n---\n\n\n\n## Review \n\nWe'll continue exploring the FEV data set from last week. Let's start by loading the data and required packages.\n\n::: {.cell}\n\n```{.r .cell-code}\n#install.packages(\"dplyr\") #uncomment and run once, if needed\n#install.packages(\"readr\") #uncomment and run once, if needed\n#install.packages(\"ggplot2\") #uncomment and run once, if needed\n\nlibrary(dplyr)\nlibrary(readr)\nlibrary(ggplot2)\n\nfev <- read_tsv(\"https://raw.githubusercontent.com/GTPB/PSLS20/master/data/fev.txt\")\nfev_tbl <- as_tibble(fev) %>% mutate(across(gender:smoking, ~ as.factor(.x))) #assign gender and smoking as factors (more on this later, too!)\n```\n:::\n\nLast week, we found that the mean FEV in the smoking group was substantially higher than the average FEV in the non-smoking group. That is, the smokers appear to have *better* lung function than the non-smokers. \n\nWe also had a theory as to why: the association between FEV and smoking status may be confounded, eg. by age/size.\n\nWe'll investigate further this week with our newly acquired plotting skills! \n\nHere are some helpful resources for making plots, now that we are moving towards less \"guided\" exercises: \n\n- [ggplot2 package webpage](https://ggplot2.tidyverse.org/index.html)\n- [ggplot2 Book](https://ggplot2-book.org/)\n- [R Graphics Cookbook](https://r-graphics.org/)\n\n## Smoking and FEV (unadjusted)\n\n### Exercise 1 \n\nNow that we have plotting tools, let's make a plot that compares the FEV of smokers to the FEV of non-smokers. \n\n::: {.cell}\n\n```{.r .cell-code}\n# FILL IN HERE\n```\n:::\n\nThis broadly tells the same story as the summaries we calculated last week, but conveys more information and is more visually engaging. \n\n## Searching for potential confounders \n\nLet's do some digging to see if we can root out some potential confounders.\n\n### Exercise 2\n\nLast week, we found that the youngest patient who smokes is 9, suggesting that there is a difference in the age distribution among smokers and non-smokers. Make a plot that compares these two distributions.\n\n::: {.cell}\n\n```{.r .cell-code}\n# FILL IN HERE\n```\n:::\n\nAgain, we see that the smokers are overall older than the non-smokers. \n\n### Exercise 3\n\nWe think that age should be related to height, which in turn should be related to FEV. Let's investigate that more systematically now with plotting. \n\nHow would you like to investigate that with plotting? Here's one suggestion, though you don't have to take it: make a plot with two panels, one that has a scatterplot of height versus age for the female patients, and one that has a scatterplot of height versus age for the male patients. \n::: {.cell}\n\n```{.r .cell-code}\n# FILL IN HERE\n```\n:::\n\nWe see that the within-sex trend is similar: height is linear-ish at younger ages, and flat-ish at older ages. Boys wind up taller at older ages. \n\nWe will then make a scatterplot of FEV versus height.\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(fev_tbl, aes(x = height, y = fev)) + \n  geom_jitter(width=0.2, alpha = 0.75) + \n  ggtitle(\"FEV versus height\") +\n  ylab(\"FEV (l/s)\") +\n  xlab(\"Height (inches)\") + \n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](fev_datavis_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\nWe see that taller participants generally have higher FEV. \n\n## Smoking and lung function: a more nuanced look\n\nNow that we know that the smokers are older and bigger and have higher FEV, let's look at the relationship between FEV and smoking status *adjusted* for height. \n\n### Exercise 4\n\nMake a scatterplot of FEV versus height, with points marked by smoking status.\n\n::: {.cell}\n\n```{.r .cell-code}\n# FILL IN HERE\n```\n:::\n\nBased on this plot, it seems like the FEV of smokers and non-smokers *of the same height* is pretty similar. \n````\n",
    "supporting": [
      "fev_datavis_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}